runs:
  using: "composite"
  steps:
   # checkout
    - uses: actions/checkout@v3
    - name: Auth NuGet
      run: dotnet nuget add source ${{ env.nuget_feed_source }} --name ${{ env.nuget_feed_name }} --username az --password ${{ secrets.AZURE_DEVOPS_TOKEN }}
  
    # build api
    - uses: ./.github/actions/build/dotnet/jobs/aspnet-core
      with:
        apply-versioning: true
        projects: src/Blab.Api/src/Blab.Api/Blab.Api.csproj
        # tests: '' # Run all csproj which match the pattern **/*.Tests.csproj
        # should-run-tests: true # TODO: Uncomment when deploying working
    # build identity
    - uses: ./.github/actions/build/dotnet/jobs/aspnet-core
      with:
        apply-versioning: true
        projects: src/Blab.Api/src/Blab.Identity/Blab.Identity.csproj
        # tests: '' # Run all csproj which match the pattern **/*.Tests.csproj
        # should-run-tests: true # TODO: Uncomment when deploying working
    # build vue app
    - uses: ./.github/actions/build/npm/jobs/npm-application
      with:
        apply-versioning: true
        projects: src/Blab.Ui
        # tests: '' # Run all csproj which match the pattern **/*.Tests.csproj
        # should-run-tests: true # TODO: Uncomment when deploying working